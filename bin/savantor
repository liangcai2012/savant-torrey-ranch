#!/usr/bin/env python

import os
import argparse

"""
Command-line interface to SavantDB administrative tools
"""

parser = argparse.ArgumentParser(description="SavantDB administrative tools")
subparsers = parser.add_subparsers(title="subcommands")

# Subparser 'setup-database'
def setup_db(args):
	from savant.db import admin
	admin.setup_database(alembic_config_path=args.alembic_config_path, reset=args.reset)

db_parser = subparsers.add_parser("setup-database", help="initialize SavantDB tables if not exist")
db_parser.add_argument("-r", "--reset", dest="reset", action="store_true", help="reset db tables")
db_parser.add_argument("-c", "--alembic-config", metavar="ALEMBIC_CONFIG", dest="alembic_config_path", help="path to alembic.ini")
db_parser.set_defaults(func=setup_db)

# Subparser IPO Populater
def download_ipo(args):
	from savant.scraper import populate_db


ipo_parser = subparsers.add_parser("populate-ipo", help="download ipo info from NASDAQ")
ipo_parser.set_defaults(func=download_ipo)

args = parser.parse_args()
args.func(args)
